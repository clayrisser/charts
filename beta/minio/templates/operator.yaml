apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: {{ template "minio.name" . }}
  annotations:
    helm.sh/hook: pre-install,pre-upgrade
    helm.sh/hook-weight: '5'
spec:
  targetNamespaces:
    - {{ .Release.Namespace }}
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: minio
  annotations:
    helm.sh/hook: pre-install,pre-upgrade
    helm.sh/hook-weight: '5'
spec:
  # https://olm.operatorframework.io/docs/tasks/install-operator-with-olm/#example-install-a-specific-version-of-an-operator
  channel: stable
  installPlanApproval: Automatic
  name: minio-operator
  source: operatorhubio-catalog
  sourceNamespace: olm
  startingCSV: minio-operator.v{{ .Chart.Version }}
# ---
# apiVersion: batch/v1
# kind: Job
# metadata:
#   name: {{ .Release.Name }}-wait
#   annotations:
#     helm.sh/hook: pre-install
#     helm.sh/hook-weight: '5'
#     helm.sh/hook-delete-policy: hook-succeeded
# spec:
#   template:
#     metadata:
#       name: wait
#     spec:
#       restartPolicy: Never
#       containers:
#         - name: wait
#           image: busybox
#           command: [/bin/sleep, '10']
