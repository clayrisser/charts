apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-pod-config
  labels:
    app: {{ template "postgres.name" . }}-postgres
    chart: {{ .Chart.Name }}-{{ .Chart.Version }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
data:
  {{- if .Values.config.walE.enabled }}
  USE_WALE: {{ .Values.config.walE.enabled | quote }}
  {{- if .Values.config.walE.schedule }}
  BACKUP_SCHEDULE: {{ .Values.config.walE.schedule | quote}}
  {{- end }}
  {{- if .Values.config.walE.retainBackups }}
  BACKUP_NUM_TO_RETAIN: {{ .Values.config.walE.retainBackups | quote}}
  {{- end }}
  {{- if .Values.config.walE.s3Bucket }}
  WAL_S3_BUCKET: {{ .Values.config.walE.s3Bucket | quote }}
  {{- end }}
  {{- if .Values.config.walE.backupThresholdMegabytes }}
  WALE_BACKUP_THRESHOLD_MEGABYTES: {{ .Values.config.walE.backupThresholdMegabytes | quote }}
  {{- end }}
  {{- if .Values.config.walE.backupThresholdPercentage }}
  WALE_BACKUP_THRESHOLD_PERCENTAGE: {{ .Values.config.walE.backupThresholdPercentage | quote }}
  {{- end }}
  {{- end }}
